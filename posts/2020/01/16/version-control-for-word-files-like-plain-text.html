<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>如何对 Word 文件进行「纯文本式」版本控制？ | TomBen</title>
    <meta name="generator" content="VuePress 1.6.0">
    <link rel="icon" href="/archived-blog/assets/img/favicon.ico">
    <link rel="alternate" type="application/rss+xml" href="https://tombener.github.io/archived-blog/rss.xml" title="TomBen RSS Feed">
    <meta name="description" content="Victory won’t come to us unless we go to it.">
    <link rel="preload" href="/archived-blog/assets/css/0.styles.804c82d6.css" as="style"><link rel="preload" href="/archived-blog/assets/js/app.80a38185.js" as="script"><link rel="preload" href="/archived-blog/assets/js/8.73126d5d.js" as="script"><link rel="preload" href="/archived-blog/assets/js/44.7425364a.js" as="script"><link rel="prefetch" href="/archived-blog/assets/js/1.2ebc6d63.js"><link rel="prefetch" href="/archived-blog/assets/js/10.90085cb8.js"><link rel="prefetch" href="/archived-blog/assets/js/11.d24d1acb.js"><link rel="prefetch" href="/archived-blog/assets/js/12.e6ba51da.js"><link rel="prefetch" href="/archived-blog/assets/js/13.611a9a4c.js"><link rel="prefetch" href="/archived-blog/assets/js/14.e1d2e753.js"><link rel="prefetch" href="/archived-blog/assets/js/15.fc9b3388.js"><link rel="prefetch" href="/archived-blog/assets/js/16.a475cb99.js"><link rel="prefetch" href="/archived-blog/assets/js/17.c1e4de0c.js"><link rel="prefetch" href="/archived-blog/assets/js/18.e4eda90a.js"><link rel="prefetch" href="/archived-blog/assets/js/19.42548c26.js"><link rel="prefetch" href="/archived-blog/assets/js/20.70c21de5.js"><link rel="prefetch" href="/archived-blog/assets/js/21.e463e0e1.js"><link rel="prefetch" href="/archived-blog/assets/js/22.1531dcc7.js"><link rel="prefetch" href="/archived-blog/assets/js/23.f239e848.js"><link rel="prefetch" href="/archived-blog/assets/js/24.81a21516.js"><link rel="prefetch" href="/archived-blog/assets/js/25.da2278a9.js"><link rel="prefetch" href="/archived-blog/assets/js/26.817f9782.js"><link rel="prefetch" href="/archived-blog/assets/js/27.6207238e.js"><link rel="prefetch" href="/archived-blog/assets/js/28.31a298f4.js"><link rel="prefetch" href="/archived-blog/assets/js/29.3fd6b50b.js"><link rel="prefetch" href="/archived-blog/assets/js/30.e74d0709.js"><link rel="prefetch" href="/archived-blog/assets/js/31.0c508190.js"><link rel="prefetch" href="/archived-blog/assets/js/32.0a4b9513.js"><link rel="prefetch" href="/archived-blog/assets/js/33.669e1584.js"><link rel="prefetch" href="/archived-blog/assets/js/34.45033851.js"><link rel="prefetch" href="/archived-blog/assets/js/35.d2e9f54c.js"><link rel="prefetch" href="/archived-blog/assets/js/36.6f2f152b.js"><link rel="prefetch" href="/archived-blog/assets/js/37.4b787b35.js"><link rel="prefetch" href="/archived-blog/assets/js/38.72ea5440.js"><link rel="prefetch" href="/archived-blog/assets/js/39.1e4b0300.js"><link rel="prefetch" href="/archived-blog/assets/js/4.9e5d7b22.js"><link rel="prefetch" href="/archived-blog/assets/js/40.bfb04b30.js"><link rel="prefetch" href="/archived-blog/assets/js/41.1d77dea6.js"><link rel="prefetch" href="/archived-blog/assets/js/42.96aab8dc.js"><link rel="prefetch" href="/archived-blog/assets/js/43.44ac205e.js"><link rel="prefetch" href="/archived-blog/assets/js/45.427d88a3.js"><link rel="prefetch" href="/archived-blog/assets/js/46.fac01d38.js"><link rel="prefetch" href="/archived-blog/assets/js/47.91e10322.js"><link rel="prefetch" href="/archived-blog/assets/js/48.20d1f0a2.js"><link rel="prefetch" href="/archived-blog/assets/js/49.c129a921.js"><link rel="prefetch" href="/archived-blog/assets/js/5.166b8173.js"><link rel="prefetch" href="/archived-blog/assets/js/50.dc5b5797.js"><link rel="prefetch" href="/archived-blog/assets/js/51.78d9bd7c.js"><link rel="prefetch" href="/archived-blog/assets/js/52.25c1a41e.js"><link rel="prefetch" href="/archived-blog/assets/js/53.205b4996.js"><link rel="prefetch" href="/archived-blog/assets/js/6.b3280247.js"><link rel="prefetch" href="/archived-blog/assets/js/7.99d3fcdf.js"><link rel="prefetch" href="/archived-blog/assets/js/9.e09ba8c2.js"><link rel="prefetch" href="/archived-blog/assets/js/vendors~flowchart.9c3bfafd.js">
    <link rel="stylesheet" href="/archived-blog/assets/css/0.styles.804c82d6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-meteorlxy"><header class="header" data-v-7a046aea><div data-v-e4145d0a data-v-7a046aea><nav class="navbar" data-v-e4145d0a><div class="container" data-v-e4145d0a><a href="/archived-blog/" class="router-link-active" data-v-e4145d0a><span class="navbar-site-name" data-v-e4145d0a>
          TomBen
        </span></a> <div class="navbar-toggler" data-v-e4145d0a><svg class="icon" style="font-size:1.2em;" data-v-e4145d0a data-v-e4145d0a><title data-v-e4145d0a data-v-e4145d0a>menu</title><use xlink:href="#icon-menu" data-v-e4145d0a data-v-e4145d0a></use></svg></div> <div class="navbar-links" data-v-e4145d0a><a href="/archived-blog/" class="navbar-link" data-v-e4145d0a>
            Home
          </a><a href="/archived-blog/posts/" class="navbar-link" data-v-e4145d0a>
            Posts
          </a><a href="/archived-blog/about/" class="navbar-link" data-v-e4145d0a>
            About
          </a></div></div></nav> <div class="navbar-holder" style="display:none;" data-v-e4145d0a></div></div> <div class="banner" data-v-98d6aa8c data-v-7a046aea data-v-7a046aea><div class="container" data-v-98d6aa8c><div class="center" data-v-98d6aa8c><h1 data-v-98d6aa8c data-v-7a046aea>
          如何对 Word 文件进行「纯文本式」版本控制？
        </h1></div></div></div></header> <div class="container clearfix show-aside" data-v-4dd605a1 data-v-4dd605a1><main class="main" data-v-4dd605a1><div class="post" data-v-4dd605a1 data-v-4dd605a1><section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      发布时间 : 2020-01-16
    </span> <!----></section> <section class="post-links" data-v-4e23451f><a href="/archived-blog/posts/2020/01/01/time-to-change-your-worse-passwords.html" class="post-link" data-v-4e23451f>
      上一篇 : 朋友，你的密码该改一改了！
    </a> <a href="/archived-blog/posts/2020/01/23/get-research-papers-on-winter-vacation.html" class="post-link" data-v-4e23451f>
      下一篇 : 寒假在家写论文，如何才能下文献
    </a></section></section> <article class="main-div"><div class="post-content content content__default"><p>做好版本控制，写作安全无虞。</p> <hr> <p><img src="https://cdn.jsdelivr.net/gh/TomBener/image-hosting/images/sspai-cover-first-post.png" alt=""></p> <p><strong>📋 目录</strong></p> <p></p><div class="table-of-contents"><ul><li><a href="#什么是版本控制">什么是版本控制？</a></li><li><a href="#为什么要做好版本控制">为什么要做好版本控制？</a><ul><li><a href="#方便版本回退">方便版本回退</a></li><li><a href="#保障文件安全">保障文件安全</a></li><li><a href="#提高协作效率">提高协作效率</a></li></ul></li><li><a href="#什么是「纯文本式」版本控制">什么是「纯文本式」版本控制？</a></li><li><a href="#git-pandoc">Git &amp; Pandoc</a><ul><li><a href="#安装-git-与-pandoc">安装 Git 与 Pandoc</a></li><li><a href="#配置-git">配置 Git</a></li><li><a href="#编辑-word-文件">编辑 Word 文件</a></li></ul></li><li><a href="#simul">Simul</a><ul><li><a href="#简介">简介</a></li><li><a href="#使用">使用</a></li></ul></li><li><a href="#总结">总结</a></li></ul></div><p></p> <h2 id="什么是版本控制"><a href="#什么是版本控制" class="header-anchor">#</a> 什么是版本控制？</h2> <p><a href="https://git-scm.com" target="_blank" rel="noopener noreferrer">Git 官网<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 对版本控制是这样解释的：</p> <blockquote><p>版本控制是一种记录一个或若干文件内容变化，以便将来查阅特定版本修订情况的系统。</p></blockquote> <p>这个解释可能不是太直白，事实上，我们可以把一个版本控制系统（VCS）理解为一个「数据库」，它可以完整地保存一个项目的快照。当需要查看一个之前的快照（称之为「版本」）时，版本控制系统可以显示出当前版本与上一个版本之间所有的改动细节。</p> <p><img src="https://cdn.jsdelivr.net/gh/TomBener/image-hosting/images/what-is-vcs.png" alt=""></p> <small><center><span style="color:gray;">版本控制示意图，图片来源于 <a href="https://www.git-tower.com/learn/git/ebook/cn/command-line/basics/what-is-version-control" target="_blank"> Tower</a></span></center></small> <h2 id="为什么要做好版本控制"><a href="#为什么要做好版本控制" class="header-anchor">#</a> 为什么要做好版本控制？</h2> <p>很多同学可能都会疑惑：版本控制好麻烦，我真的需要吗？</p> <blockquote><p>You never think you need version control until you do......</p></blockquote> <p>也许，正如上面这句稍显无奈的话所说，无论我在这里怎么强调版本控制的重要性，都不如你亲身经历一次没有版本控制带来的后果更加有效。版本控制对于管理源代码非常重要，但是对于写作来说，它的观念模式同样适用，也非常重要。版本控制有非常多的好处，对于写作来说，主要体现在下面这几个方面。</p> <h3 id="方便版本回退"><a href="#方便版本回退" class="header-anchor">#</a> 方便版本回退</h3> <p>一般来说，写文章尤其是写毕业论文，不是一蹴而就的，会经过一段时间，期间产生多个版本。而我们有时不仅仅需要当前版本，历史版本也是具有价值的。例如，由于操作不当，错误地删除了当前版本的内容，想要回退到上一个版本；写作过程中，觉得之前的版本更好，想要从删除的内容中找回一点灵感，不如从之前的版本开始写。</p> <p>macOS 的 <a href="https://support.apple.com/zh-cn/HT201250" target="_blank" rel="noopener noreferrer">时间机器<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>（Time Machine）就是一个操作系统级别的版本控制工具，与此同时，macOS 上的很多软件也集成了基本的版本控制，例如 Apple Pages 就具备一定的 <a href="https://support.apple.com/zh-cn/guide/pages/tan7f1de6ec5/mac" target="_blank" rel="noopener noreferrer">版本控制功能<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，在 Pages 中点击 <code>复原到 -&gt; 浏览所有版本</code>，就可以查看每次保存的版本，选择相应版本即可回退至该版本。</p> <p><img src="https://cdn.jsdelivr.net/gh/TomBener/image-hosting/images/pages-version-control.png" alt=""></p> <h3 id="保障文件安全"><a href="#保障文件安全" class="header-anchor">#</a> 保障文件安全</h3> <p>相信不少同学或多或少都遇到过文件损坏或丢失的情况：</p> <ul><li>自己误操作或软件崩溃导致文件丢失</li> <li>突然停电，台式机中正在编辑的 Word 文件未保存</li> <li>设备故障或 <a href="https://wxn.qq.com/cmsid/HBC2017032102077504" target="_blank" rel="noopener noreferrer">被盗<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，其中未备份的文件全部丢失</li> <li>设备被 <a href="http://www.xinhuanet.com//politics/2017-05/14/c_1120967940.htm" target="_blank" rel="noopener noreferrer">勒索病毒<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 攻击，必须付款才能打开</li> <li>洪水、龙卷风或野兽来袭，存储文件的设备被损坏</li> <li>......</li></ul> <p>大约一个月前，一位同学由于毕业论文开题报告保存的版本不对，给我发了下方截图中的消息。虽然我给她发了找回历史版本的 <a href="https://support.office.com/zh-cn/article/%E6%9F%A5%E7%9C%8B-office-%E6%96%87%E4%BB%B6%E7%9A%84%E5%85%88%E5%89%8D%E7%89%88%E6%9C%AC-5c1e076f-a9c9-41b8-8ace-f77b9642e2c2?ui=zh-CN&amp;rs=zh-CN&amp;ad=CN" target="_blank" rel="noopener noreferrer">Office 官方文档<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，她自己也尝试了网上的各种「偏方」，但最终还是以失败告终，没能找回上次保存的开题报告，不得不「擦干眼泪，从头再来」。</p> <p>虽然遇到这种情况很糟心，但在最后，我还是苦口婆心地向她强调版本控制的重要性。这也是我写这篇文章的原因之一，希望你能未雨绸缪、防患于未然，不再有我的同学这样的遭遇。</p> <p><img src="https://cdn.jsdelivr.net/gh/TomBener/image-hosting/images/deng-wechat-chat.jpg" alt=""></p> <p>假设我的这位同学利用 Git 对开题报告的 Word 文件做好了版本控制，并将其存储在 GitHub 之类的远程服务器上，或者哪怕将 Word 文件保存在 OneDrive 之类的网盘中，也一定不会遭遇这种情况，不至于「从头再来」。</p> <h3 id="提高协作效率"><a href="#提高协作效率" class="header-anchor">#</a> 提高协作效率</h3> <p>如果没有版本控制，可能你就会面临下图中的情形：自己不断修改，形成 <code>final.docx</code>、<code>final_1.docx</code>、<code>final_2.docx</code>...... 与导师或协作者通过邮件、QQ、微信等工具相互发送 <code>final_rev.docx</code>、<code>final_rev_1.docx</code>、<code>final_rev_2.docx</code>...... 这简直就是扼杀创造力的行为！</p> <p></p><div class="text-align-center"><img src="https://cdn.jsdelivr.net/gh/TomBener/image-hosting/images/phd-comic-101212s.png" alt=""></div> <small><center><span style="color:gray;">Not Final，图片来源于 <a href="http://phdcomics.com/comics/archive.php?comicid=1531" target="_blank"> PHD Comics</a></span></center></small><p></p> <h2 id="什么是「纯文本式」版本控制"><a href="#什么是「纯文本式」版本控制" class="header-anchor">#</a> 什么是「纯文本式」版本控制？</h2> <p>Kieran Healy 教授 <a href="http://plain-text.co/index.html#introduction" target="_blank" rel="noopener noreferrer">认为<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，办公室模式（The Office Model）倾向于使用 Microsoft Word 这种集合式的工具，对 Word 文件所做的修改记录存储在文件内部<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>，以 Microsoft Word 中的「修订」为代表；而工程师模式（The Engineerings Model）中，纯文本文件是工作的中心，对纯文本文件所作的修改记录存储在文件外部，以 Git 为代表。</p> <p>我在之前的文章中 <a href="https://tombener.github.io/archived-blog/posts/2019/10/06/suggestions-for-writing-thesis.html#%E7%BD%91%E7%9B%98" target="_blank" rel="noopener noreferrer">介绍到<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，Git 主要针对纯文本文件进行版本控制，面对 <code>.docx</code> 或 <code>.doc</code> 这类二进制文件的表现并不如人意。虽然 Dropbox、坚果云之类的网盘可以进行简单的版本控制，但它们能做到的，仅仅是让用户知道某一个时刻保存的某一个版本，但不能知道文件内部的修改情况。当我们想要恢复之前的版本时，由于不知道文件内部到底是怎么修改的，因此到底应该恢复哪一个版本，就会感到困惑。</p> <p><img src="https://cdn.jsdelivr.net/gh/TomBener/image-hosting/images/dropbox-web.png" alt=""></p> <p>因此，「纯文本式」版本控制可以这样界定：</p> <blockquote><p>「纯文本式」版本控制是指在文件外部进行，并且能够记录文件内部修改情况的一种版本控制。</p></blockquote> <p><img src="https://cdn.jsdelivr.net/gh/TomBener/image-hosting/images/without-plain-text-version-control.png" alt=""></p> <p><img src="https://cdn.jsdelivr.net/gh/TomBener/image-hosting/images/with-plain-text-version-contro.png" alt=""> <small><center><span style="color:gray;">直观理解「纯文本式」版本控制。上图为非「纯文本式」版本控制，下图为「纯文本式」版本控制</span></center></small></p> <p>那么，如何对 Word 文件进行「纯文本式」版本控制呢？下面介绍两种方法：Git &amp; Pandoc 和 Simul。</p> <h2 id="git-pandoc"><a href="#git-pandoc" class="header-anchor">#</a> Git &amp; Pandoc</h2> <p>Git 最初是被用来对软件源代码进行版本控制，对 <code>.docx</code> 这样的二进制文件的支持不太友好。但是借助 Pandoc，我们可以实现「曲线救国」，通过将 <code>.docx</code> 文件转换为 <code>.md</code> 文件，来实现 Git 对 <code>.docx</code> 进行「纯文本式」版本控制。</p> <h3 id="安装-git-与-pandoc"><a href="#安装-git-与-pandoc" class="header-anchor">#</a> 安装 Git 与 Pandoc</h3> <ul><li>前往 <a href="https://git-scm.com/downloads" target="_blank" rel="noopener noreferrer">Git 官网<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，选择对应的操作系统版本，下载安装 Git。</li> <li>前往 <a href="https://pandoc.org/installing.html" target="_blank" rel="noopener noreferrer">Pandoc 官网<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，下载安装对应系统版本的 Pandoc。</li></ul> <p>如果你的操作系统是 macOS，推荐使用 <a href="https://brew.sh" target="_blank" rel="noopener noreferrer">Homebrew<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 来安装 Git 和 Pandoc：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>brew <span class="token function">install</span> <span class="token function">git</span> pandoc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="配置-git"><a href="#配置-git" class="header-anchor">#</a> 配置 Git</h3> <p>在用户文件夹下找到文件 <code>.gitconfig</code>，使用文本编辑器打开它，加入下面的内容，然后保存。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>diff <span class="token string">&quot;pandoc&quot;</span><span class="token punctuation">]</span>
   <span class="token assign-left variable">textconv</span><span class="token operator">=</span>pandoc --to<span class="token operator">=</span>markdown
   prompt <span class="token operator">=</span> <span class="token boolean">false</span>
 <span class="token punctuation">[</span>alias<span class="token punctuation">]</span>
   wdiff <span class="token operator">=</span> <span class="token function">diff</span> --word-diff<span class="token operator">=</span>color --unified<span class="token operator">=</span><span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>新建一个文件夹，这里命名为 <code>git-word-demo</code>。</p> <p>初始化 Git 仓库</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 进入 git-word-demo 文件夹</span>
<span class="token builtin class-name">cd</span> git-word-demo
<span class="token comment"># 创建 Git 仓库</span>
<span class="token function">git</span> initial
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>在 <code>git-word-demo</code> 目录下，新建一个文件 <code>.gitattributes</code>，写入下面的内容，然后保存。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>*.docx <span class="token assign-left variable">diff</span><span class="token operator">=</span>pandoc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="编辑-word-文件"><a href="#编辑-word-文件" class="header-anchor">#</a> 编辑 Word 文件</h3> <p>在 <code>git-word-demo</code> 文件夹下，新建一个 Word 文件，这里命名为 <code>example.docx</code>，然后按照平常一样进行编辑，完成之后保存并提交，进入该目录，在终端中输入：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> wdiff example.docx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>就可以像纯文本一样，看到增加或删除的内容。当然，使用 Git 的 GUI 客户端会更加直观，比如 <a href="https://desktop.github.com" target="_blank" rel="noopener noreferrer">GitHub Desktop<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，如下图所示，绿色表示增加的部分，红色表示减少的部分。</p> <p><img src="https://cdn.jsdelivr.net/gh/TomBener/image-hosting/images/git-diff-github-desktop.png" alt=""></p> <p>以上操作的文件可以在我的 <a href="https://github.com/TomBener/git-word-demo" target="_blank" rel="noopener noreferrer">GitHub 仓库<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> fork 或下载。</p> <h2 id="simul"><a href="#simul" class="header-anchor">#</a> Simul</h2> <h3 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h3> <p><a href="https://www.simuldocs.com/" target="_blank" rel="noopener noreferrer">Simul<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 是一个为 Microsoft Word 设计的版本控制和协作工具，使用 Simul 可以轻松地与他人进行协作，对 Word 文件进行「纯文本式」版本控制，<a href="https://twitter.com/simuldocs/status/1170568886934073344" target="_blank" rel="noopener noreferrer">Simul 的推特<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 称它是「Microsoft Word 中的 Git」。</p> <p><img src="https://cdn.jsdelivr.net/gh/TomBener/image-hosting/images/hompage-simul-docs.png" alt=""></p> <p>Simul 集成了 Dropbox、OneDrive、Google Drive 等常见网盘，具有自动记录版本、版本比较、分支、合并、回退等功能。免费版本拥有 1 GB 存储空间、1 个文档创建者、1 个文件<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>以及不限数量的协作者，如果需要更多的创建者、文件数量和使用 Simul 的 API，需要升级到 Individual 或更高级的套餐，详情可参考下表。</p> <table><thead><tr><th style="text-align:center;">Free</th> <th style="text-align:center;">Individual</th> <th style="text-align:center;">Squad</th> <th style="text-align:center;">Team</th></tr></thead> <tbody><tr><td style="text-align:center;">$0</td> <td style="text-align:center;">$15 / 月</td> <td style="text-align:center;">$35 / 月</td> <td style="text-align:center;">$75 / 月</td></tr> <tr><td style="text-align:center;">1 个创建者</td> <td style="text-align:center;">1 个创建者</td> <td style="text-align:center;">5 个创建者</td> <td style="text-align:center;">7 个创建者</td></tr> <tr><td style="text-align:center;">1 个文件</td> <td style="text-align:center;">文件数量无限制</td> <td style="text-align:center;">文件数量无限制</td> <td style="text-align:center;">文件数量无限制</td></tr> <tr><td style="text-align:center;">不限数量的协作者</td> <td style="text-align:center;">不限数量的协作者</td> <td style="text-align:center;">不限数量的协作者</td> <td style="text-align:center;">不限数量的协作者</td></tr></tbody></table> <p>此外，对于学生、教师和非营利性组织，Simul 的所有套餐享有 50% 的优惠，可以前往 <a href="https://app.simuldocs.com/contact" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 填写邮箱和申请请求，之后就会收到 5 折兑换码。</p> <h3 id="使用"><a href="#使用" class="header-anchor">#</a> 使用</h3> <ol><li><strong>创建文件</strong></li></ol> <p>Simul 支持三种创建 Word 文件的方式：</p> <ul><li>上传文件</li> <li>创建空白文件</li> <li>从 SharePoint、OneDrive、Dropbox、Google Drive、Box 导入文件</li></ul> <p><img src="https://cdn.jsdelivr.net/gh/TomBener/image-hosting/images/import-simul-ocuments.png" alt=""></p> <ol start="2"><li><strong>编辑文件</strong></li></ol> <p>创建或导入文件之后，点击右上角的「OPEN IN WORD」或「Open in Word Online」，就会打开桌面版或在线版 Word，在其中编辑保存之后，会自动存储到 Simul 中，默认生成 <code>0.0.x</code> 这样的版本号，也可以点击「Name this version」，手动为每个版本重命名。对于编辑过的部分，Simul 会在左侧用竖线进行标记，用蓝色表示增加的部分，红色表示减少的部分，并且可以在下方下载各个版本的 PDF 文件。</p> <p><img src="https://cdn.jsdelivr.net/gh/TomBener/image-hosting/images/document-history-simul-documents.png" alt=""></p> <ol start="3"><li><strong>创建副本</strong></li></ol> <p>点击右上角的更多按钮，再点击「Push to copy」就可以创建文件的副本。副本是基于当前版本的一个新文档，类似于 Git 中的分支（branch）。在需要的时候，可以在副本中编辑，然后合并到主文档，点击「MERGE」，就可以将副本合并到主文档中。</p> <p><img src="https://cdn.jsdelivr.net/gh/TomBener/image-hosting/images/simul-docs-merge.png" alt=""></p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>Git &amp; Pandoc 的组合与 Simul 各有优劣：</p> <table><thead><tr><th style="text-align:center;">Tools</th> <th style="text-align:center;">Git &amp; Pandoc</th> <th style="text-align:center;">Simul</th></tr></thead> <tbody><tr><td style="text-align:center;">优势</td> <td style="text-align:center;">基于 Git，操作很自然</td> <td style="text-align:center;">操作简单，不需要代码基础</td></tr> <tr><td style="text-align:center;">劣势</td> <td style="text-align:center;">需要一定的 Git 使用经验</td> <td style="text-align:center;">价格较高，不能离线使用</td></tr></tbody></table> <p>因此，我们建议，如果你有一定的 Git 经验，推荐使用 Git &amp; Pandoc 来对 Word 文件进行「纯文本式」版本控制；如果你不熟悉 Git，可以考虑使用 Simul。当然，如果你认为，自己确确实实不需要这种「纯文本式」版本控制，甚至都不需要版本控制，请记住，一定要<strong>做好备份</strong>！</p> <hr class="footnotes-sep"> <section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>文件修改记录存储在文件内部的一大弊端就是文件损坏，版本记录也会随之丢失。 <a href="#fnref1" class="footnote-backref">↩︎</a></p></li> <li id="fn2" class="footnote-item"><p>这里 1 个文件是指正在编辑的工作文件，对于已完成编辑的文件，可以归档，归档的文件不会占用文件数量。 <a href="#fnref2" class="footnote-backref">↩︎</a></p></li></ol></section></div></article> <section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      发布时间 : 2020-01-16
    </span> <!----></section> <section class="post-links" data-v-4e23451f><a href="/archived-blog/posts/2020/01/01/time-to-change-your-worse-passwords.html" class="post-link" data-v-4e23451f>
      上一篇 : 朋友，你的密码该改一改了！
    </a> <a href="/archived-blog/posts/2020/01/23/get-research-papers-on-winter-vacation.html" class="post-link" data-v-4e23451f>
      下一篇 : 寒假在家写论文，如何才能下文献
    </a></section></section> <div id="post-comments" class="main-div"><!----></div></div></main> <aside class="aside" data-v-4dd605a1><div class="info-card main-div" data-v-9d847660 data-v-4dd605a1><div class="info-card-header" data-v-9d847660><img src="/archived-blog/images/avatar.png" alt="TomBen" class="info-avatar" data-v-9d847660></div> <div class="info-card-body" data-v-9d847660><section class="info-nickname" data-v-9d847660>
      TomBen
    </section> <section class="info-desc" data-v-9d847660>Victory won’t come to us unless we go to it.</section> <section class="info-contact" data-v-9d847660><section data-v-9d847660><span title="Chengdu, China" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>Chengdu, China</title><use xlink:href="#icon-location" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          Chengdu, China
        </span></span></section> <section data-v-9d847660><span title="Sichuan University" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>Sichuan University</title><use xlink:href="#icon-organization" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          Sichuan University
        </span></span></section> <section data-v-9d847660><a href="mailto:retompi@gmail.com" title="retompi@gmail.com" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>retompi@gmail.com</title><use xlink:href="#icon-email" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          retompi@gmail.com
        </span></a></section></section></div> <div class="info-card-footer" data-v-9d847660><section class="info-sns clearfix" data-v-9d847660><a href="https://github.com/TomBener" target="_blank" class="sns-link" data-v-9d847660><span title="GitHub: TomBener" class="sns-icon" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1.5em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>GitHub: TomBener</title><use xlink:href="#icon-github" data-v-9d847660 data-v-9d847660></use></svg></span></a><a href="https://twitter.com/TomBener" target="_blank" class="sns-link" data-v-9d847660><span title="Twitter: TomBener" class="sns-icon" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1.5em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>Twitter: TomBener</title><use xlink:href="#icon-twitter" data-v-9d847660 data-v-9d847660></use></svg></span></a></section></div></div> <div class="post-nav-card main-div" style="position:relative;top:0;width:0px;" data-v-4dd605a1><div class="post-nav-contents"><svg class="icon"><title>book</title><use xlink:href="#icon-book"></use></svg> <span>文章目录</span> <div class="post-nav-toc"><ul><li><a href="/archived-blog/posts/2020/01/16/version-control-for-word-files-like-plain-text.html#什么是版本控制">什么是版本控制？</a></li><li><a href="/archived-blog/posts/2020/01/16/version-control-for-word-files-like-plain-text.html#为什么要做好版本控制">为什么要做好版本控制？</a><ul><li><a href="/archived-blog/posts/2020/01/16/version-control-for-word-files-like-plain-text.html#方便版本回退">方便版本回退</a></li><li><a href="/archived-blog/posts/2020/01/16/version-control-for-word-files-like-plain-text.html#保障文件安全">保障文件安全</a></li><li><a href="/archived-blog/posts/2020/01/16/version-control-for-word-files-like-plain-text.html#提高协作效率">提高协作效率</a></li></ul></li><li><a href="/archived-blog/posts/2020/01/16/version-control-for-word-files-like-plain-text.html#什么是「纯文本式」版本控制">什么是「纯文本式」版本控制？</a></li><li><a href="/archived-blog/posts/2020/01/16/version-control-for-word-files-like-plain-text.html#git-pandoc">Git &amp; Pandoc</a><ul><li><a href="/archived-blog/posts/2020/01/16/version-control-for-word-files-like-plain-text.html#安装-git-与-pandoc">安装 Git 与 Pandoc</a></li><li><a href="/archived-blog/posts/2020/01/16/version-control-for-word-files-like-plain-text.html#配置-git">配置 Git</a></li><li><a href="/archived-blog/posts/2020/01/16/version-control-for-word-files-like-plain-text.html#编辑-word-文件">编辑 Word 文件</a></li></ul></li><li><a href="/archived-blog/posts/2020/01/16/version-control-for-word-files-like-plain-text.html#simul">Simul</a><ul><li><a href="/archived-blog/posts/2020/01/16/version-control-for-word-files-like-plain-text.html#简介">简介</a></li><li><a href="/archived-blog/posts/2020/01/16/version-control-for-word-files-like-plain-text.html#使用">使用</a></li></ul></li><li><a href="/archived-blog/posts/2020/01/16/version-control-for-word-files-like-plain-text.html#总结">总结</a></li></ul></div></div> <div class="post-nav-comments"><svg class="icon"><title>comment</title><use xlink:href="#icon-comment"></use></svg> <a href="/archived-blog/posts/2020/01/16/version-control-for-word-files-like-plain-text.html#post-comments">
      评论
    </a></div></div></aside></div> <footer class="footer" data-v-1375e54c><p class="footer-sns-links" data-v-1375e54c><a href="https://github.com/TomBener" target="_blank" class="sns-link" data-v-1375e54c><span title="GitHub: TomBener" class="sns-icon" data-v-1375e54c data-v-1375e54c><svg class="icon" style="font-size:25px;" data-v-1375e54c data-v-1375e54c><title data-v-1375e54c data-v-1375e54c>GitHub: TomBener</title><use xlink:href="#icon-github" data-v-1375e54c data-v-1375e54c></use></svg></span></a><a href="https://twitter.com/TomBener" target="_blank" class="sns-link" data-v-1375e54c><span title="Twitter: TomBener" class="sns-icon" data-v-1375e54c data-v-1375e54c><svg class="icon" style="font-size:25px;" data-v-1375e54c data-v-1375e54c><title data-v-1375e54c data-v-1375e54c>Twitter: TomBener</title><use xlink:href="#icon-twitter" data-v-1375e54c data-v-1375e54c></use></svg></span></a></p> <!----> <p class="footer-text" data-v-1375e54c><font style="line-height:1.5;"> <a href="https://tombener.github.io/archived-blog/rss.xml"> <img border="0" alt="RSS" src="https://img.shields.io/badge/dynamic/json?color=FFA500&label=Subscribe%20via%20RSS&query=%24.data.totalSubs&url=https%3A%2F%2Fapi.spencerwoo.com%2Fsubstats%2F%3Fsource%3Dfeedly%26queryKey%3Dhttps%3A%2F%2Ftombener.github.io%2Farchived-blog%2Frss&logo=rss"></a><br> Great Thanks for Your <a href="https://retompi.com/sponsor-page/" target="_blank">Donation ❤️</a><br> Copyright &copy; 2019&nbsp-&nbsp2020 <a href="mailto:retompi@gmail.com">TomBen 😋</a><br> Powered by <a href="https://github.com/vuejs/vuepress" target="_blank">VuePress</a> & <a href="https://github.com/meteorlxy/vuepress-theme-meteorlxy" target="_blank"> Meteorlxy 🚀</a><br></p></footer></div><div class="global-ui"><!----><!----></div></div>
    <script src="/archived-blog/assets/js/app.80a38185.js" defer></script><script src="/archived-blog/assets/js/8.73126d5d.js" defer></script><script src="/archived-blog/assets/js/44.7425364a.js" defer></script>
  </body>
</html>
